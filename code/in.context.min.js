/*!
 * Intention.js + Context.js Library v0.9.6
 * http://intentionjs.com/
 *
 * Copyright 2011, 2013 Dowjones and other contributors
 * Released under the MIT license
 *
 */
(function(f,d){"object"===typeof exports?module.exports=d(require("jquery")):"function"===typeof define&&define.amd?define(["jquery","underscore"],d):f.Intention=d(f.jQuery,f._)})(this,function(f,d){var h=function(h){return d.extend(this,h,{_listeners:{},contexts:[],elms:f(),axes:{},priority:[]})};h.prototype={responsive:function b(a,c){var g="",e;for(e=0;5>e;e++)g+="abcdefghijklmnopqrstuvwxyz0123456789"[Math.floor(36*Math.random())];g={matcher:function(c,b){return c===b.name},measure:d.identity,
ID:g};!1===d.isObject(c)&&(c={});if(d.isArray(a)&&d.isArray(a[0].contexts))d.each(a,function(c){b.apply(this,c)},this);else return!1===d.isArray(a)&&d.isObject(a)?c=a:c.contexts=a,c=d.extend({},g,c),this.on(c.ID,d.bind(function(b){this.axes=this._contextualize(c.ID,b.context,this.axes);this._respond(this.axes,this.elms)},this)),g={ID:[c.ID],current:null,contexts:c.contexts,respond:d.bind(this._responder(c.ID,c.contexts,c.matcher,c.measure),this)},this.axes[c.ID]=g,this.axes.__keys__=this.priority,
this.priority.unshift(c.ID),g},elements:function(b){b||(b=document);f("[data-intent],[intent],[data-in],[in]",b).each(d.bind(function(b,c){this.add(f(c))},this));return this},add:function(b,a){var c;a||(a={});b.each(d.bind(function(b,e){var k=!1;this.elms.each(function(c,b){if(e===b)return k=!0,!1});!1===k&&(c=this._fillSpec(d.extend(a,this._attrsToSpec(e.attributes))),this._makeChanges(f(e),c,this.axes),this.elms.push({elm:e,spec:c}))},this));return this},remove:function(b){var a=this.elms;b.each(function(c,
b){a.each(function(c,d){if(b===d.elm)return a.splice(c,1),!1})});return this},is:function(b){var a=this.axes;return d.some(a.__keys__,function(c){return b===a[c].current})},on:function(b,a){void 0===this._listeners[b]&&(this._listeners[b]=[]);this._listeners[b].push(a);return this},off:function(b,a){if(d.isArray(this._listeners[b])){var c=this._listeners[b],g;for(g=0;c.length;g++)if(c[g]===a){c.splice(g,1);break}}return this},_responder:function(b,a,c,g){var e;return function(){var k=g.apply(this,
arguments);d.every(a,function(a){if(c(k,a)){if(void 0===e||a.name!==e.name)e=a,this._emitter(d.extend({},{_type:e.name},e),this)._emitter({_type:b,context:e.name},this);return!1}return!0},this);return this}},_emitter:function(b){"string"===typeof b&&(b={_type:b});b.target||(b.target=this);if(!b._type)throw Error(b._type+" is not a supported event.");if(d.isArray(this._listeners[b._type])){var a=this._listeners[b._type],c;for(c=0;c<a.length;c++)a[c].call(this,b)}return this},_fillSpec:function(b){var a=
function(c){d.each(b,c)},c={};a(function(b){d.isObject(b)&&d.each(b,function(b,a){c[a]=""})});a(function(a,e){d.isObject(a)&&(b[e]=d.extend({},c,a))});return b},_attrsToSpec:function(b){var a={},c=/^(data-)?(in|intent)-([a-zA-Z0-9][_a-zA-Z0-9]*)-([A-Za-z:-]+)/,g=/^(data-)?(in|intent)-([a-zA-Z0-9][_a-zA-Z0-9]*)$/;d.each(b,function(b){var d=b.name.match(c);if(null!==d){var d=d.slice(-2),l=d[0],f=a,h=a[l]||{};h[d[1]]=b.value;f[l]=h;a=f}else g.test(b.name)&&(a["_"+b.name.match(g)[3]]=b.value)});return a},
_resolveSpecs:function(b,a){var c={},g=["append","prepend","before","after"];d.each(b,function(b){d.each(a[b],function(b,a){if("class"===a)c[a]||(c[a]=[]),c[a]=d.union(c[a],b.split(" "));else if((void 0===c.move||""===c.move.value)&&-1!==f.inArray(a,g))c.move={value:b,placement:a};else if(void 0===c[a]||""===c[a])c[a]=b},this)},this);return c},_currentContexts:function(b){var a=[];d.each(b.__keys__,function(c){null!==b[c].current&&a.push(b[c].current)});return a},_removeClasses:function(b,a){var c=
[];d.each(a.__keys__,function(g){var e=a[g],k=!1;void 0!==b["_"+e.ID]&&(k=!0);d.each(e.contexts,function(a){a.name!==e.current&&(k&&c.push(a.name),a=b[a.name],void 0!==a&&void 0!==a["class"]&&(a=a["class"].split(" "),void 0!==a&&(c=d.union(c,a))))},this)},this);return c},_contextConfig:function(b,a){var c=this._resolveSpecs(this._currentContexts(a),b,a);d.each(b,function(b,e){var k;this._axis_test_pattern.test(e)&&(k=e.match(this._axis_match_pattern)[1],a[k]&&(c["class"]=d.union(c["class"],[a[k].current,
b])))},this);return c},_makeChanges:function(b,a,c){if(!1===d.isEmpty(c)){var g=this._contextConfig(a,c);d.each(g,function(e,g){if("move"===g){if(a.__placement__!==e.placement||a.__move__!==e.value)f(e.value)[e.placement](b),a.__placement__=e.placement,a.__move__=e.value}else if("class"===g){var h=b.attr("class")||"",h=d.union(e,d.difference(h.split(" "),this._removeClasses(a,c)));b.attr("class",h.join(" "))}else b.attr(g,e)},this)}return b},_respond:function(b,a){a.each(d.bind(function(c,a){var d=
f(a.elm);this._makeChanges(d,a.spec,b);d.trigger("intent",this)},this))},_contextualize:function(b,a,c){c[b].current=a;return c},_axis_test_pattern:/^_[^_]/,_axis_match_pattern:/^_([a-zA-Z0-9][_a-zA-Z0-9]*)/};return h});(function(){var f=function(d,h){var f=new h,b,a;f.responsive([{name:"base"}]).respond("base");b=f.responsive({ID:"width",contexts:[{name:"standard",min:840},{name:"tablet",min:510},{name:"mobile",min:0}],matcher:function(c,a){return"string"===typeof c?c===a.name:c>=a.min},measure:function(a){return"string"===typeof a?a:d(window).width()}});a=f.responsive({ID:"orientation",contexts:[{name:"portrait",rotation:0},{name:"landscape",rotation:90}],matcher:function(a,b){return a===b.rotation},measure:function(){var a=
Math.abs(window.orientation);0<a&&(a=180-a);return a}});f.responsive({ID:"touch",contexts:[{name:"touch"}],matcher:function(){return"ontouchstart"in window}}).respond();f.responsive({ID:"highres",contexts:[{name:"highres"}],matcher:function(){return 1<window.devicePixelRatio}}).respond();d(window).on("resize",function(a,b){var d=new Date,f=null;return function(h){var m=new Date;if(m-d<b)return f&&window.clearTimeout(f),f=window.setTimeout(function(b){return function(){a(b)}}(h),b),!1;a(h);d=m}}(b.respond,
100)).on("orientationchange",b.respond).on("orientationchange",a.respond);b.respond();a.respond();d(function(){f.elements(document)});return f};(function(d,f){"function"===typeof define&&define.amd?define(["jquery","Intention"],f):d.intent=f(d.jQuery,d.Intention)})(this,function(d,h){return f(d,h)})}).call(this);
